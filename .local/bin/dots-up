#!/bin/bash
# updots
touch $HOME/.pkgs
touch $HOME/.pkgignore

# Do an update
cp -f $HOME/.pkgs $HOME/.pkgs.backup
sudo pacmatic -Syu
paru -Syu

# Install Any PKGs needed but not ignored from .pkgs
paru -Qqe |
  sort |
  comm -23 <(sort $HOME/.pkgs) - |
  comm -13 <(sort $HOME/.pkgignore) - |
  paru -S - --needed


# Regenerate .pkgs ignoring ignored pkgs
paru -Qqe |
  sort |
  comm -13 <(sort $HOME/.pkgignore) - > $HOME/.pkgs

codium --diff $HOME/.pkgs $HOME/.pkgs.backup --wait
